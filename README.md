# Laravel Malware Validation Rule
 Scans uploaded files for viruses and other malware

## Installation

To install the Laravel Malware Validation Rule package, run the following command

```bash
composer require divineomega/laravel-malware-validation-rule
```

This package makes use of the ClamAV daemon to perform virus/malware scanning. You can 
install ClamAV in Ubuntu/Debian with the following command.

```bash
sudo apt install clamav-daemon
```

Initially, your ClamAV installation will likely come with either no virus defintions, or
outdated ones. You can install/update your ClamAV virus defintions using the `freshclam`
command. It is recommended to restart the ClamAV daemon after the virus defintions have
been updated to ensure they take effect.

```bash
sudo freshclam
sudo service clamav-daemon restart
```

## Usage

See the following basic usage example, which demonstrates how to validate a basic
file upload does not contain contain a known virus/malware.

```php
use \DivineOmega\LaravelMalwareValidationRule\Rules\Malware;

// ...

public function rules()
{
    return [
        'my_file' => ['required', 'file', new Malware()],
    ];
}
```

By default the validation rule message will include the name of the detected 
virus/malware. If you do not wish the malware name to be shown in the 
validation message you can turn this off as shown below.

```php
public function rules()
{
    $showMalwareName = false;

    return [
        'my_file' => ['required', 'file', new Malware($showMalwareName)],
    ];
}
```

